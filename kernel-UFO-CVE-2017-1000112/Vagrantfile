# -*- mode: ruby -*-
# vi: set ft=ruby :


$script = <<-SCRIPT
usermod -aG docker vagrant
sudo cat /etc/default/grub | sed 's/GRUB_CMDLINE_LINUX=""/GRUB_CMDLINE_LINUX="nopti nokaiser nokaslr nosmap"/' | sudo tee /etc/default/grub
update-grub
SCRIPT
# cp /vagrant/runc /usr/sbin/docker-runc

Vagrant.configure("2") do |config|


    # Every Vagrant development environment requires a box. You can search for
    # boxes at https://vagrantcloud.com/search.
    config.vm.box = "ubuntu/xenial64"
    config.vm.hostname = "UFO-machine"

    # Share an additional folder to the guest VM. The first argument is
    # the path on the host to the actual folder. The second argument is
    # the path on the guest to mount the folder. And the optional third
    # argument is a set of non-required options.
    config.vm.synced_folder "../commonShare", "/commonShare"

    config.vm.provision "shell" do |s|
        s.path = "../commonShare/install-kernel.sh"
        s.args   = ["4.8.0-34"]
    end
    config.vm.provision :reload
    config.vm.provision "shell" do |s|
        s.path = "../commonShare/get-docker.sh"
    end
    config.vm.provision "shell", inline: $script
    config.vm.provision :reload
end
